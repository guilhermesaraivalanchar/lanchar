#card_login
  section#wrapper
    .login-register style=("display: block;") 
      .login-box.card
        .card-body
          form#loginform.form-horizontal.form-material action="" 
            h3.box-title.m-b-20 Entrar
            h4#msg_alt_senha.box-title.m-b-20 style="display:none" Como é seu primeiro login, escolher uma nova senha.
            div#input_usuario.form-group
              h5.box-title.m-b-20 Matricula
              .col-xs-12
                input#user_codigo.form-control readonly="readonly" placeholder="Username" required="true" type="text" /
            div#input_senha.form-group style="display:none"
              h5.box-title.m-b-20 Senha
              .col-xs-12
                input#user_pass.form-control readonly="readonly" placeholder="Password" required="true" type="password" /
            div#input_alt_senha.form-group style="display:none"
              h5.box-title.m-b-20 Alterar Senha ( 4 digitos )
              .col-xs-12
                input#user_alt_pass.form-control readonly="readonly" placeholder="Password" required="true" type="password" /
            .form-group.text-center.m-t-20
              .col-xs-12
                div#check_teclado_login
                  button.btn.btn-info.btn-lg.btn-block.waves-effect.waves-light type="button" Verificar
                button#entrar.btn.btn-info.btn-lg.btn-block.waves-effect.waves-light type="button" style="display:none" Entrar
                button#botao_alt_senha.btn.btn-info.btn-lg.btn-block.waves-effect.waves-light type="button" style="display:none" Mudar Senha
                
                div#erro_senha.error_validate class="alert alert-danger" style="text-align: center; display:none" Codigo ou senha incorreta.
                div#erro_usu_ativo.error_validate class="alert alert-danger" style="text-align: center; display:none" Usuário desativado.
            .row#teclado_login
              .col-4
                div.error_validate class="alert alert-info" onclick="login_botao(1)" style="height: 90px;text-align: center; vertical-align: middle; line-height: 60px; font-size: 30px"
                  = "1"
              .col-4
                div.error_validate class="alert alert-info" onclick="login_botao(2)" style="height: 90px;text-align: center; vertical-align: middle; line-height: 60px; font-size: 30px"
                  = "2"
              .col-4
                div.error_validate class="alert alert-info" onclick="login_botao(3)" style="height: 90px;text-align: center; vertical-align: middle; line-height: 60px; font-size: 30px"
                  = "3"
              .col-4
                div.error_validate class="alert alert-info" onclick="login_botao(4)" style="height: 90px;text-align: center; vertical-align: middle; line-height: 60px; font-size: 30px"
                  = "4"
              .col-4
                div.error_validate class="alert alert-info" onclick="login_botao(5)" style="height: 90px;text-align: center; vertical-align: middle; line-height: 60px; font-size: 30px"
                  = "5"
              .col-4
                div.error_validate class="alert alert-info" onclick="login_botao(6)" style="height: 90px;text-align: center; vertical-align: middle; line-height: 60px; font-size: 30px"
                  = "6"
              .col-4
                div.error_validate class="alert alert-info" onclick="login_botao(7)" style="height: 90px;text-align: center; vertical-align: middle; line-height: 60px; font-size: 30px"
                  = "7"
              .col-4
                div.error_validate class="alert alert-info" onclick="login_botao(8)" style="height: 90px;text-align: center; vertical-align: middle; line-height: 60px; font-size: 30px"
                  = "8"
              .col-4
                div.error_validate class="alert alert-info" onclick="login_botao(9)" style="height: 90px;text-align: center; vertical-align: middle; line-height: 60px; font-size: 30px"
                  = "9"
              .col-8
                div.error_validate class="alert alert-info" onclick="login_botao(0)" style="height: 90px;text-align: center; vertical-align: middle; line-height: 60px; font-size: 30px"
                  = "0"
              .col-4
                div.error_validate class="alert alert-info" onclick="login_botao_apagar()" style="height: 90px;text-align: center; vertical-align: middle; line-height: 60px; font-size: 30px"
                  = "X"

            .row#teclado_senha style="display:none"
              .col-6
                div#botao_senha_1.error_validate class="alert alert-info" style="height: 90px;text-align: center; vertical-align: middle; line-height: 60px; font-size: 30px"
                  = "1"
                  font style="font-size: 15px; margin-left: 30px; margin-right: 30px" ou
                  = "2"
              .col-6
                div#botao_senha_2.error_validate class="alert alert-info" style="height: 90px;text-align: center; vertical-align: middle; line-height: 60px; font-size: 30px"
                  = "1"
                  font style="font-size: 15px; margin-left: 30px; margin-right: 30px" ou
                  = "2"
              .col-6
                div#botao_senha_3.error_validate class="alert alert-info" style="height: 90px;text-align: center; vertical-align: middle; line-height: 60px; font-size: 30px"
                  = "1"
                  font style="font-size: 15px; margin-left: 30px; margin-right: 30px" ou
                  = "2"
              .col-6
                div#botao_senha_4.error_validate class="alert alert-info" style="height: 90px;text-align: center; vertical-align: middle; line-height: 60px; font-size: 30px"
                  = "1"
                  font style="font-size: 15px; margin-left: 30px; margin-right: 30px" ou
                  = "2"
              .col-6
                div#botao_senha_5.error_validate class="alert alert-info" style="height: 90px;text-align: center; vertical-align: middle; line-height: 60px; font-size: 30px"
                  = "1"
                  font style="font-size: 15px; margin-left: 30px; margin-right: 30px" ou
                  = "2"
              .col-6
                div#botao_senha_6.error_validate class="alert alert-info" onclick="login_botao_apagar()" style="height: 90px;text-align: center; vertical-align: middle; line-height: 60px; font-size: 30px"
                  = "X"
javascript:

  var botao_senha_1 = [1, 2]
  var botao_senha_2 = [1, 2]
  var botao_senha_3 = [1, 2]
  var botao_senha_4 = [1, 2]
  var botao_senha_5 = [1, 2]

  var modo_alt_senha = false
  var modo_confirmar_alt_senha = false
  var senha_para_alterar = ""
  var teclado = [1, 2, 3, 4, 5, 6, 7, 8, 9, 0]
  function misturar_teclado_senha(){
    teclado = []
    while (teclado.length < 10) {
      var x = Math.floor((Math.random() * 10));
      tem = false
      for (i in teclado){
        if (teclado[i] == x){
          tem = true
        }
      }

      if (!tem){
        teclado.push(x)
      }
    }
  }

  function montar_botoes_senha(){
    botao_senha_1 = [teclado[0],teclado[1]]
    botao_senha_2 = [teclado[2],teclado[3]]
    botao_senha_3 = [teclado[4],teclado[5]]
    botao_senha_4 = [teclado[6],teclado[7]]
    botao_senha_5 = [teclado[8],teclado[9]]
    $("#botao_senha_1").html(botao_senha_1[0]+'<font style="font-size: 15px; margin-left: 20px; margin-right: 20px">ou</font> '+botao_senha_1[1])
    $("#botao_senha_2").html(botao_senha_2[0]+'<font style="font-size: 15px; margin-left: 20px; margin-right: 20px">ou</font> '+botao_senha_2[1])
    $("#botao_senha_3").html(botao_senha_3[0]+'<font style="font-size: 15px; margin-left: 20px; margin-right: 20px">ou</font> '+botao_senha_3[1])
    $("#botao_senha_4").html(botao_senha_4[0]+'<font style="font-size: 15px; margin-left: 20px; margin-right: 20px">ou</font> '+botao_senha_4[1])
    $("#botao_senha_5").html(botao_senha_5[0]+'<font style="font-size: 15px; margin-left: 20px; margin-right: 20px">ou</font> '+botao_senha_5[1])
  }

  function mudar_botoes_senha(){
    misturar_teclado_senha()
    montar_botoes_senha()
  }

  $("#botao_senha_1").click(function(){ add_em_senha(); senha.push(botao_senha_1); })
  $("#botao_senha_2").click(function(){ add_em_senha(); senha.push(botao_senha_2); })
  $("#botao_senha_3").click(function(){ add_em_senha(); senha.push(botao_senha_3); })
  $("#botao_senha_4").click(function(){ add_em_senha(); senha.push(botao_senha_4); })
  $("#botao_senha_5").click(function(){ add_em_senha(); senha.push(botao_senha_5); })
  $("#botao_senha_6").click(function(){ $("#user_pass").val(""); senha = []; })

  function add_em_senha(){
    $("#user_pass").val($("#user_pass").val()+"1")
  }

  var usuario = ""

  var senha = []

  function login_botao(numero){

    if(modo_alt_senha){
      log = $("#user_alt_pass")
    }else{
      log = $("#user_codigo")
    }

    log.val(log.val() + numero)
  }

  function login_botao_apagar() {
    if(modo_alt_senha){
      $("#user_alt_pass").val("")
    }else{
      log = $("#user_codigo")
      var newStr = log.val().substring(0, log.val().length-1);
      log.val(newStr)
    }
    
  }

  $("#botao_alt_senha").click(function(){
    if(!modo_confirmar_alt_senha){
      var alt_senha = $("#user_alt_pass").val()
      if(alt_senha.length != 4){
        alert("A senha deve conter 4 digitos.")
      }else{
        senha_para_alterar = alt_senha
        $("#botao_alt_senha").html('Confirmar Senha')
        modo_confirmar_alt_senha = true
        $("#user_alt_pass").val("")
      }
    }else{
      if(senha_para_alterar != $("#user_alt_pass").val()){
        alert("Senhas digitadas não sao iguais.")
      }else{
        mudar_senha_e_logar(senha_para_alterar)
      }     
    }
  })

  function mudar_senha_e_logar(senha_para_alterar){
    $("#login_page").hide()
    $("#equip_page").show()

    iniciar_produto()

    $.post("/alt_senha_user",
    {
      user_id: user_id,
      senha: senha_para_alterar
    },
    function(data, status){

      console.log(data)
      console.log(status)

    });

  }

  $("#check_teclado_login").click(function(){
    usuario = $("#user_codigo").val()
    $("#teclado_login").hide()
    $("#teclado_senha").show()
    $("#input_usuario").hide()
    $("#input_senha").show()
    $("#check_teclado_login").hide()
    $("#entrar").show()
  })


  var totem_token = ""
  $(document).ready(function() {
    mudar_botoes_senha()

    var url_string = window.location.href; //window.location.href
    var url = new URL(url_string);
    totem_token = url.searchParams.get("t");
    console.log(t);

  })


  var produtos_all = []
  var combos_all = []
  var tipos_all = []
  var filtros_all = []
  var user_nome = ""
  var user_saldo_disponivel = 0
  var user_url = ""
  var user_id = ""
  var user_saldo_total = 0
  var user_credito = 0
  var user_diario = 0
  var user_saldo_total_credito = 0
  var user_saldo_gasto_hoje = 0

  $("#entrar").click(function(){

      var totem_token = "7D5Nt_e9qFD707n78DBoWA"

      $.post("/login_totem",
      {
        c: usuario,
        p: senha,
        t: totem_token
      },
      function(data, status){

        console.log(data)
        console.log(status)

        if (data.status == "200"){
          produtos_all = data.all_produtos
          combos_all = data.all_combos
          tipos_all = data.all_tipos
          filtros_all = data.all_filtros
          user_nome = data.user_nome
          user_saldo_disponivel = data.saldo_disponivel
          user_url = data.user_url
          user_id = data.user_id
          user_saldo_total = data.saldo_total
          user_credito = data.saldo_credito
          user_diario = data.saldo_diario
          user_saldo_total_credito = data.saldo_total_credito
          user_saldo_gasto_hoje = data.user_saldo_gasto_hoje
          $("#login_page").hide()
          $("#equip_page").show()
    

          iniciar_produto()
        }else if(data.status == "SENHA_INCORRETA" || data.status == "CODIGO_NAO_ENCONTRADO"){
          $("#user_codigo").val("")
          $("#teclado_login").show()
          $("#teclado_senha").hide()
          $("#input_usuario").show()
          $("#input_senha").hide()
          $("#check_teclado_login").show()
          $("#entrar").hide()
          $("#erro_senha").show()
          $("#user_pass").val("")
          senha = []
        }else if(data.status == "USUARIO_INATIVO"){
          $("#user_codigo").val("")
          $("#teclado_login").show()
          $("#teclado_senha").hide()
          $("#input_usuario").show()
          $("#input_senha").hide()
          $("#check_teclado_login").show()
          $("#entrar").show()
          $("#erro_usu_ativo").show()
        }else if(data.status == "SENHA_INICIAL"){
          
          produtos_all = data.all_produtos
          combos_all = data.all_combos
          tipos_all = data.all_tipos
          user_nome = data.user_nome
          user_saldo_disponivel = data.saldo_disponivel
          user_url = data.user_url
          user_id = data.user_id
          user_saldo_total = data.saldo_total
          user_credito = data.saldo_credito
          user_diario = data.saldo_diario
          user_saldo_total_credito = data.saldo_total_credito
          user_saldo_gasto_hoje = data.user_saldo_gasto_hoje

          $("#teclado_login").show()
          $("#teclado_senha").hide()
          $("#input_usuario").hide()
          $("#input_senha").hide()
          $("#input_alt_senha").show()
          $("#check_teclado_login").hide()
          $("#entrar").hide()
          $("#erro_usu_ativo").hide()
          $("#botao_alt_senha").show()
          $("#msg_alt_senha").show()
          modo_alt_senha = true
        }

      });
  })
